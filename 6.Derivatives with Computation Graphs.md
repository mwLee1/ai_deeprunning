

# ğŸ§  Derivatives with Computation Graphs: ê³„ì‚° ê·¸ë˜í”„ ê¸°ë°˜ ë¯¸ë¶„ ê³„ì‚°

## 1. ğŸš€ ê³„ì‚° ê·¸ë˜í”„ì™€ ì—­ì „íŒŒëŠ” ë¬´ì—‡ì¸ê°€?

**ê³„ì‚° ê·¸ë˜í”„(Computation Graph)** ëŠ” ìˆ˜í•™ì  ê³„ì‚°ì„ **ë…¸ë“œ(Node)** ì™€ **ì—°ì‚°(Edge)** ë¡œ êµ¬ì„±í•œ ìœ í–¥ ë¹„ìˆœí™˜ ê·¸ë˜í”„(DAG)ì…ë‹ˆë‹¤.
ì´ëŠ” ë³µì¡í•œ í•¨ìˆ˜ ì—°ì‚°ì„ ë¶„í•´í•´ **ì—°ì‡„ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³ **, íŠ¹íˆ **ë¯¸ë¶„ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê³„ì‚°**í•˜ëŠ” ë° í™œìš©ë©ë‹ˆë‹¤.

ë”¥ëŸ¬ë‹ì—ì„œëŠ” ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ **ì •ë°©í–¥ ì „íŒŒ(forward pass)** ì™€ **ì—­ë°©í–¥ ì „íŒŒ(backward pass)** ë¥¼ ìˆ˜í–‰í•˜ì—¬ ëª¨ë¸ í•™ìŠµì„ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.

---

## 2. ğŸ“Œ ëŒ€ìƒ í•¨ìˆ˜: \$J = 3(a + bc)\$

ì´ í•¨ìˆ˜ëŠ” ì•„ë˜ì™€ ê°™ì€ í˜•íƒœë¡œ ë‚˜ë‰©ë‹ˆë‹¤:

### ğŸ”§ ì—°ì‚° ë¶„í•´

$$
\begin{aligned}
u &= bc \\
v &= a + u \\
J &= 3v
\end{aligned}
$$

â†’ ì¦‰, **ê³± â†’ ë§ì…ˆ â†’ ê³±** ìˆœì„œë¡œ êµ¬ì„±ëœ í•¨ìˆ˜ì…ë‹ˆë‹¤.

---

## 3. ğŸ” ì •ë°©í–¥ íŒ¨ìŠ¤ (Forward Pass)

ì˜ˆë¥¼ ë“¤ì–´:

* \$a = 5\$, \$b = 3\$, \$c = 2\$

ì´ë¼ë©´:

$$
\begin{aligned}
u &= bc = 3 \times 2 = 6 \\
v &= a + u = 5 + 6 = 11 \\
J &= 3v = 3 \times 11 = \boxed{33}
\end{aligned}
$$

---

## 4. ğŸ”„ ì—­ë°©í–¥ íŒ¨ìŠ¤ (Backward Pass): ê·¸ë˜ë””ì–¸íŠ¸ ì „íŒŒ

ìš°ë¦¬ëŠ” ì´ì œ **ì¶œë ¥ \$J\$ì— ëŒ€í•œ ì…ë ¥ ë³€ìˆ˜ë“¤ì˜ ë„í•¨ìˆ˜ \$\frac{\partial J}{\partial a}, \frac{\partial J}{\partial b}, \frac{\partial J}{\partial c}\$** ë¥¼ ê³„ì‚°í•©ë‹ˆë‹¤.
ì´ ê³¼ì •ì€ **ì²´ì¸ ë£°(chain rule)** ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ **ê·¸ë˜ë””ì–¸íŠ¸ ì „íŒŒ**ì…ë‹ˆë‹¤.

---

### ğŸ“˜ ê°œë…ì  ë„ì‹
[Mermaid Live Editor](https://mermaid.live)
```
graph LR
    a[a = 5<br/>âˆ‚J/âˆ‚a = 3] --> v
    b[b = 3<br/>âˆ‚J/âˆ‚b = 6] --> u
    c[c = 2<br/>âˆ‚J/âˆ‚c = 9] --> u
    u[u = bc = 6<br/>âˆ‚J/âˆ‚u = 3] --> v
    v[v = a + u = 11<br/>âˆ‚J/âˆ‚v = 3] --> J[J = 3v = 33<br/>âˆ‚J/âˆ‚J = 1]

```

---

### â–¶ ë‹¨ê³„ë³„ ë¯¸ë¶„ ê³„ì‚°

---

### ğŸ”¹ Step 1: \$\frac{\partial J}{\partial v}\$

$$
J = 3v \Rightarrow \frac{\partial J}{\partial v} = 3
$$

> ğŸ’¡ "vê°€ 1 ì¦ê°€í•˜ë©´ JëŠ” 3ë§Œí¼ ì¦ê°€í•œë‹¤"

---

### ğŸ”¹ Step 2: \$\frac{\partial J}{\partial a}\$

$$
v = a + u \Rightarrow \frac{\partial v}{\partial a} = 1
\Rightarrow \frac{\partial J}{\partial a} = \frac{\partial J}{\partial v} \cdot \frac{\partial v}{\partial a} = 3 \cdot 1 = \boxed{3}
$$

---

### ğŸ”¹ Step 3: \$\frac{\partial J}{\partial u}\$

$$
\frac{\partial v}{\partial u} = 1
\Rightarrow \frac{\partial J}{\partial u} = \frac{\partial J}{\partial v} \cdot \frac{\partial v}{\partial u} = 3 \cdot 1 = \boxed{3}
$$

---

### ğŸ”¹ Step 4: \$\frac{\partial J}{\partial b}\$

$$
u = bc \Rightarrow \frac{\partial u}{\partial b} = c = 2
\Rightarrow \frac{\partial J}{\partial b} = \frac{\partial J}{\partial u} \cdot \frac{\partial u}{\partial b} = 3 \cdot 2 = \boxed{6}
$$

---

### ğŸ”¹ Step 5: \$\frac{\partial J}{\partial c}\$

$$
\frac{\partial u}{\partial c} = b = 3
\Rightarrow \frac{\partial J}{\partial c} = \frac{\partial J}{\partial u} \cdot \frac{\partial u}{\partial c} = 3 \cdot 3 = \boxed{9}
$$

---

## 5. ğŸ§  Chain Ruleì˜ êµ¬ì¡°ì  ì ìš©

ëª¨ë“  ë„í•¨ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì—°ì‡„ ê·œì¹™ì„ ë”°ë¦…ë‹ˆë‹¤:

$$
\frac{\partial J}{\partial x} = \sum_{\text{ê²½ë¡œ}} \left( \prod_{\text{ê²½ë¡œìƒì˜ ë…¸ë“œ}} \text{local gradient} \right)
$$

â†’ **ëª¨ë“  ê²½ë¡œë¥¼ ë”°ë¼ê°€ë©° ê³±í•˜ê³ , ê²½ë¡œê°€ ì—¬ëŸ¬ ê°œì¸ ê²½ìš° ë”í•¨**
â†’ ì´ êµ¬ì¡°ëŠ” í•©ì„±í•¨ìˆ˜, ë³‘ë ¬ ë…¸ë“œ, ë¸Œëœì¹˜ êµ¬ì¡°ê¹Œì§€ ì¼ë°˜í™”ë©ë‹ˆë‹¤.

---

## 6. ğŸ“Š ê³„ì‚° ê·¸ë˜í”„ ì‹œê°í™” (Forward + Gradient í¬í•¨)

```python
import networkx as nx
import matplotlib.pyplot as plt

a, b, c = 5, 3, 2
u = b * c
v = a + u
J = 3 * v

dJ_dv = 3
dJ_da = dJ_dv * 1
dJ_du = dJ_dv * 1
dJ_db = dJ_du * c
dJ_dc = dJ_du * b

G = nx.DiGraph()
G.add_edges_from([
    ("b", "u"), ("c", "u"),
    ("u", "v"), ("a", "v"),
    ("v", "J")
])
pos = {"a": (0, 2), "b": (0, 1), "c": (0, 0), "u": (1, 0.5), "v": (2, 1), "J": (3, 1)}
labels = {
    "a": f"a=5\nâˆ‚J/âˆ‚a={dJ_da}",
    "b": f"b=3\nâˆ‚J/âˆ‚b={dJ_db}",
    "c": f"c=2\nâˆ‚J/âˆ‚c={dJ_dc}",
    "u": f"u=bc=6",
    "v": f"v=a+u=11\nâˆ‚J/âˆ‚v=3",
    "J": f"J=3v=33"
}

plt.figure(figsize=(10, 4))
nx.draw(G, pos, with_labels=False, node_color='lightblue', node_size=3000, edge_color='gray')
nx.draw_networkx_labels(G, pos, labels, font_size=10)
plt.title("Computation Graph with Gradients", fontsize=14)
plt.axis('off')
plt.tight_layout()
plt.show()
```

---

## 7. âœ… ìš”ì•½ ì •ë¦¬

| í•­ëª©           | ì„¤ëª…                              |
| ------------ | ------------------------------- |
| **ì •ë°©í–¥ íŒ¨ìŠ¤**   | ê³„ì‚° ê·¸ë˜í”„ë¥¼ ë”°ë¼ ì…ë ¥ì—ì„œ ì¶œë ¥ê¹Œì§€ ê°’ì„ ê³„ì‚°      |
| **ì—­ë°©í–¥ íŒ¨ìŠ¤**   | ì¶œë ¥ì—ì„œ ì…ë ¥ìœ¼ë¡œ ì²´ì¸ ë£°ì„ í†µí•´ ê·¸ë˜ë””ì–¸íŠ¸ë¥¼ ì „íŒŒ    |
| **ì—°ì‡„ ë²•ì¹™**    | ë³µí•© í•¨ìˆ˜ì˜ ë„í•¨ìˆ˜ë¥¼ ë‹¨ê³„ì ìœ¼ë¡œ ê³±í•´ì„œ ì „íŒŒ        |
| **ë…¸ë“œë³„ ë„í•¨ìˆ˜**  | ê° ì—°ì‚°ì˜ ì§€ì—­ ë„í•¨ìˆ˜ë¥¼ ì •ì˜í•˜ë©´ ì „ì²´ ë„í•¨ìˆ˜ ê³„ì‚° ê°€ëŠ¥ |
| **ë”¥ëŸ¬ë‹ì—ì„œ ì—­í• ** | ì†ì‹¤ í•¨ìˆ˜ì˜ ê·¸ë˜ë””ì–¸íŠ¸ë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ì—­ì „íŒŒí•˜ì—¬ í•™ìŠµ ì§„í–‰ |

